{
    "info": {
        "name": "RAG-Bidding API - Query Enhancement Tests",
        "description": "Test collection for Query Enhancement & Modular Retriever Architecture",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "item": [
        {
            "name": "1. Health Check",
            "request": {
                "method": "GET",
                "header": [],
                "url": {
                    "raw": "http://localhost:8000/health",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "health"
                    ]
                },
                "description": "Check API server and database connectivity"
            }
        },
        {
            "name": "2. Fast Mode (No Enhancement)",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"question\": \"Điều kiện tham gia đấu thầu là gì?\",\n    \"mode\": \"fast\"\n}"
                },
                "url": {
                    "raw": "http://localhost:8000/ask",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "ask"
                    ]
                },
                "description": "Test BaseVectorRetriever - Simple vector search without query enhancement\n\nExpected:\n- Processing time: ~200ms\n- No query enhancement\n- 5 documents retrieved"
            }
        },
        {
            "name": "3. Balanced Mode (Multi-Query)",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"question\": \"So sánh đấu thầu rộng rãi và chỉ định thầu?\",\n    \"mode\": \"balanced\"\n}"
                },
                "url": {
                    "raw": "http://localhost:8000/ask",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "ask"
                    ]
                },
                "description": "Test EnhancedRetriever with Multi-Query strategy\n\nExpected:\n- Processing time: ~500ms\n- Query enhancement enabled (3-5 variations)\n- Automatic deduplication\n- 5 documents retrieved"
            }
        },
        {
            "name": "4. Quality Mode (RAG-Fusion + RRF)",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"question\": \"Phân tích ưu nhược điểm các hình thức đấu thầu?\",\n    \"mode\": \"quality\"\n}"
                },
                "url": {
                    "raw": "http://localhost:8000/ask",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "ask"
                    ]
                },
                "description": "Test FusionRetriever with RAG-Fusion & RRF algorithm\n\nExpected:\n- Processing time: ~1200ms\n- Multi-Query + HyDE strategies\n- RRF ranking fusion\n- Best quality results"
            }
        },
        {
            "name": "5a. Adaptive Mode - Simple Query",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"question\": \"Thời hạn nộp hồ sơ dự thầu?\",\n    \"mode\": \"adaptive\"\n}"
                },
                "url": {
                    "raw": "http://localhost:8000/ask",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "ask"
                    ]
                },
                "description": "Test AdaptiveKRetriever with SIMPLE query\n\nExpected:\n- Complexity: SIMPLE\n- K: 3 documents\n- Processing time: ~300ms\n- Optimized for speed"
            }
        },
        {
            "name": "5b. Adaptive Mode - Complex Query",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"question\": \"Phân tích chi tiết quy trình đấu thầu rộng rãi quốc tế theo Luật Đấu thầu 2023, so sánh với quy định cũ và tác động đến doanh nghiệp vừa và nhỏ?\",\n    \"mode\": \"adaptive\"\n}"
                },
                "url": {
                    "raw": "http://localhost:8000/ask",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "ask"
                    ]
                },
                "description": "Test AdaptiveKRetriever with COMPLEX query\n\nExpected:\n- Complexity: COMPLEX\n- K: 8-10 documents\n- Processing time: ~800ms\n- Comprehensive coverage"
            }
        },
        {
            "name": "6. Test Query Enhancement - Multi-aspect",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"question\": \"Quy định về bảo lãnh dự thầu và bảo lãnh thực hiện hợp đồng?\",\n    \"mode\": \"balanced\"\n}"
                },
                "url": {
                    "raw": "http://localhost:8000/ask",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "ask"
                    ]
                },
                "description": "Test query with multiple aspects (bảo lãnh dự thầu + bảo lãnh thực hiện)\n\nQuery enhancement should generate:\n- Query about 'bảo lãnh dự thầu'\n- Query about 'bảo lãnh thực hiện'\n- Comparison query\n\nExpect comprehensive answer covering both types"
            }
        },
        {
            "name": "7. Test Deduplication",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"question\": \"Điều kiện năng lực nhà thầu?\",\n    \"mode\": \"balanced\"\n}"
                },
                "url": {
                    "raw": "http://localhost:8000/ask",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "ask"
                    ]
                },
                "description": "Test deduplication logic\n\nMultiple queries may retrieve same documents\nEnhancedRetriever should deduplicate based on content hash\n\nCheck: No duplicate documents in sources"
            }
        },
        {
            "name": "8. Edge Case - Very Short Query",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"question\": \"HSMT?\",\n    \"mode\": \"balanced\"\n}"
                },
                "url": {
                    "raw": "http://localhost:8000/ask",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "ask"
                    ]
                },
                "description": "Test edge case: Very short query (abbreviation)\n\nQuery enhancement should expand:\nHSMT → Hồ sơ mời thầu, Tài liệu đấu thầu, etc."
            }
        },
        {
            "name": "9. Edge Case - Empty Question",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"question\": \"\",\n    \"mode\": \"balanced\"\n}"
                },
                "url": {
                    "raw": "http://localhost:8000/ask",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "ask"
                    ]
                },
                "description": "Test error handling: Empty question\n\nExpected:\n- HTTP 400 Bad Request\n- Error message: 'question is required'"
            }
        },
        {
            "name": "10. Performance Comparison - Same Query All Modes",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"question\": \"Hình thức lựa chọn nhà thầu có những loại nào?\",\n    \"mode\": \"fast\"\n}"
                },
                "url": {
                    "raw": "http://localhost:8000/ask",
                    "protocol": "http",
                    "host": [
                        "localhost"
                    ],
                    "port": "8000",
                    "path": [
                        "ask"
                    ]
                },
                "description": "Run same query with all modes to compare:\n\n1. Fast mode (~200ms)\n2. Balanced mode (~500ms)\n3. Quality mode (~1200ms)\n4. Adaptive mode (~300-800ms)\n\nCompare:\n- Processing time\n- Answer quality\n- Number of sources\n- Relevance"
            }
        }
    ]
}